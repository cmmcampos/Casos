<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../plantilla/plantilla4.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"

                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <br></br>
    <br></br>
    <br></br>
    <br></br>
    <br></br>
    <ui:define name="content">



        <h:form id="formCasos"  prependId="true" style="width: 100%" >
            <p:accordionPanel id="agregaSolicitante" multiple="true" activeIndex="1">

                <p:tab title="1- Solicitante">
                    <p:panelGrid id="datosUsuario" style="width: 100%;">
                        <f:facet name="header">
                            <p:row>
                                <p:column colspan="4"><h:outputLabel value="Datos del Usuario Solicitante"/></p:column>
                            </p:row>
                        </f:facet>
                        <p:row>
                            <p:column colspan="4">
                                <p:column colspan="1">
                                    <p:commandButton disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}"  value="Seleccionar usuario" oncomplete="agregaUsuario.show();" />
                                </p:column>  
                                <p:column colspan="1"><h:outputLabel value="Nombre:  " style="font-weight: bold"/></p:column>
                                <p:column colspan="1"><h:outputText value=" #{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.nombreUsuario}  #{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.apellidoUsuario}" style="font-weight: bold"/></p:column>

                            </p:column> 
                        </p:row>

                        <p:row>
                            <p:column><h:outputLabel value="Teléfono: " style="font-weight: bold"/></p:column> 
                            <p:column><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.telefonoUsuario}" /></p:column>
                            <p:column><h:outputLabel value="Correo Electrónico:" style="font-weight: bold"/></p:column> 
                            <p:column><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.correoUsuario}" /></p:column> 
                        </p:row>

                        <p:row>
                            <p:column colspan="1"><h:outputLabel value="Dependencia a la que pertenece:  " style="font-weight: bold"/> </p:column>
                            <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.idDependencia.nombreDependencia}"/> </p:column>
                            <p:column colspan="1"><h:outputLabel value="Jefe de la Dependencia:  " style="font-weight: bold"/> </p:column>
                            <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.idDependencia.jefeDependencia}"/> </p:column>                          
                        </p:row>

                        <p:row>

                        </p:row>

                        <p:row>
                            <p:column colspan="2"><h:outputLabel value="Dependencia / Unidad organizativa:  " style="font-weight: bold"/> </p:column>
                            <p:column colspan="2"><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.idDependencia.idDirecInter.nombreDirecInter}"/> </p:column>

                        </p:row>

                        <p:row>
                            <p:column colspan="2"><h:outputLabel value="Dirección Nacional:  " style="font-weight: bold"/> </p:column>
                            <p:column colspan="2"><h:outputText value="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.idDependencia.idDirecInter.idDirNacional.nombreDirNacional}"/> </p:column>

                        </p:row>

                    </p:panelGrid>

                </p:tab>
                <p:tab title="2- Detalle de Requerimiento"  >
                    <p:panelGrid id="datosCaso" style="width: 100%;">
                        <f:facet name="header">
                            <p:row>
                                <p:column colspan="6"><h:outputLabel value="Datos del Servicio Requerido"/></p:column>
                            </p:row>
                        </f:facet>
                        <p:row>
                            <p:column><h:outputLabel style="font-weight: bold" value="Vía de soliciud: "/></p:column>
                            <p:column colspan="2">
                                <p:selectOneMenu disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}"  id="ueNom" value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.idViaSolicitud.idViaSolicitud}" style="width: 200px">
                                    <f:selectItem itemLabel="Seleccione..." itemValue="0"/>
                                    <f:selectItems value="#{controladorAdicionCaso.listViaSolic}" var="viaSoli" itemLabel="#{viaSoli.nombreViaSolicitud}" itemValue="#{viaSoli.idViaSolicitud}"/>
                                </p:selectOneMenu>
                            </p:column>

                            <p:column colspan="1"><h:outputLabel style="font-weight: bold" value="Fecha del Requerimiento: "/></p:column>
                            <p:column colspan="2"> <p:calendar disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}" value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.fechaRequerimiento}" pattern="dd/MM/yyyy"/> </p:column>


                        </p:row>
                        <p:row>
                            <p:column colspan="1"><h:outputLabel style="font-weight: bold" value="Categoría del Servicio: "/></p:column>
                            <p:column colspan="2">
                                <p:selectOneMenu disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}"  id="ctServ" value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.idCatServ.idCatServ}" style="width: 200px">
                                    <f:selectItem itemLabel="Seleccione..." itemValue="0"/>
                                    <f:selectItems value="#{controladorAdicionCaso.listCatServ}" var="catServi" itemLabel="#{catServi.nombreCatServ}" itemValue="#{catServi.idCatServ}"/>
                                </p:selectOneMenu>
                            </p:column>    



                            <p:column colspan="1"><h:outputLabel style="font-weight: bold" value="Requiere documentación: "/></p:column>
                            <p:column colspan="1">

                                <p:selectBooleanCheckbox disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}"  id="saas"  value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.documentacionCompleta}">
                                   
                                    <p:ajax update="mlp msg12" listener="#{controladorAdicionCaso.control2()}"></p:ajax>
                                </p:selectBooleanCheckbox>

                            </p:column>   




                        </p:row>
                        <p:row>       
                            <p:column colspan="2">
                                <p:outputPanel id="mlp">
                                       

                                    <c:if test="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.documentacionCompleta}">                                  

                                        <p:column colspan="2">
                                            <center> <p:commandButton rendered="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.documentacionCompleta}" disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}" value="Ver Adjuntos" oncomplete="verDoc.show();" ></p:commandButton></center>
                                        </p:column>
                                    </c:if>
                                    
                                    <c:if test="#{!controladorAdicionCaso.requerimientoSeleccionadoAModificar.documentacionCompleta}">                                  

                                        <p:column colspan="2">
                                            <center> <p:commandButton disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}" value="Subir Adjuntos" oncomplete="subi.show();"></p:commandButton></center>
                                        </p:column>
                                    </c:if>
                                    

                                </p:outputPanel>
                            </p:column>            
                        </p:row>

                        <p:row>
                            <p:column colspan="6" style="text-align: center">
                                <h:outputLabel value="Descripción del Requerimiento" style="font-weight: bold"/>
                                <p:inputTextarea disabled="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}" value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.descripcionRequerimiento}" rows="4" style="width: 99%;" autoResize="true"/>
                            </p:column>
                        </p:row>

                    </p:panelGrid>




                    <p:commandButton  oncomplete="redireccionar()" icon="ui-icon-disk" value="#{controladorAdicionCaso.operacionARealizar}" onclick="if (!confirm('Deseas #{controladorAdicionCaso.operacionARealizar} el Requerimiento solicitado por: #{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.nombreUsuario}  #{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar.apellidoUsuario}?'))
                                return false;" action="#{controladorAdicionCaso.updateRequerimiento()}" process="@this datosCaso" update=":formCasos:agregaSolicitante msg12">
                        <c:if test="#{controladorAdicionCaso.operacionARealizar.equals('Modificar')}" >
                            <f:param name="operacion" value="Modificar"/>
                        </c:if>
                        <c:if test="#{controladorAdicionCaso.operacionARealizar.equals('Eliminar')}" >
                            <f:param name="operacion" value="Eliminar"/>
                        </c:if>
                    </p:commandButton>

                    <p:growl id="msg12"/>     
                </p:tab>

            </p:accordionPanel>





            <script language="javascript">
                function redireccionar() {
                    setTimeout("javascript:location.replace('for_consultaCasos.xhtml')", 900);
                }
            </script>


        </h:form> 


        <h:form id="verAr" enctype="multipart/form-data">

            <p:dialog header="Cargar Archivo" widgetVar="verDoc" modal="true">
                <p:dataTable id="tablaDocAdjuntos" value="#{controladorAdicionCaso.requerimientoSeleccionadoAModificar.documentosList}" var="item12"  rows="5" paginator="true" paginatorPosition="bottom" >                   

                    <p:column>       
                        <f:facet name="header">
                            <h:outputText value="Nombre del Documento"/>
                        </f:facet>
                        <h:outputText value="#{item12.nombreDocumento}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="Descargar"/>
                        </f:facet>
                        <p:commandButton value="Abrir"  icon="ui-icon-arrowthick-1-s"  ajax="false">  
                            <p:fileDownload value="#{controladorAdicionCaso.asigFile12(item12)}" />  
                        </p:commandButton> 
                    </p:column>  
                </p:dataTable>   

            </p:dialog>
        </h:form>

        

        <h:form id="subirAr" enctype="multipart/form-data">
            <p:dialog header="Cargar Archivo" widgetVar="subi" modal="true">
                <p:fileUpload id="uplo" value="#{controladorAdicionCaso.file21}" mode="simple" required="true" allowTypes="/(\.|\/)(gif|jpe?g|png|pdf)$/" update="msg12"></p:fileUpload>
                <h:commandButton id="Subir" value="Subir Archivo" onclick="subi.hide();" class="btn btn-success">
                    <!--<f:param name="tipo" value="nuevo"/>-->
                </h:commandButton> 

            </p:dialog>
            <p:growl id="msg12"/>       
        </h:form>

        

        <h:form id="qwerty">
            <p:dialog header="Seleccione un Usuario:" widgetVar="agregaUsuario" modal="true">
                <p:dataTable id="tablaUsuarios" value="#{controladorAdicionCaso.listUsuarios}" var="item" rowKey="#{item.usuarioUsuario}" rows="10" paginator="true" 
                             selection="#{controladorAdicionCaso.usuarioSolicitanteSelecionadoAModificar}" selectionMode="single">

                    <p:column filterBy="#{item.nombreUsuario}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Nombre"/>
                        </f:facet>
                        <h:outputText value="#{item.nombreUsuario}"/>
                    </p:column>
                    <p:column filterBy="#{item.apellidoUsuario}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Apellido"/>
                        </f:facet>
                        <h:outputText value="#{item.apellidoUsuario}"/>
                    </p:column>
                    <p:column filterBy="#{item.correoUsuario}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Correo de Usuario"/>
                        </f:facet>
                        <h:outputText value="#{item.correoUsuario}"/>
                    </p:column>

                    <p:column filterBy="#{item.telefonoUsuario}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Telefono de Usuario"/>
                        </f:facet>
                        <h:outputText value="#{item.telefonoUsuario}"/>
                    </p:column>
                    <p:column filterBy="#{item.idDependencia.nombreDependencia}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Dependencia de Usuario"/>
                        </f:facet>
                        <h:outputText value="#{item.idDependencia.nombreDependencia}"/>
                    </p:column>

                </p:dataTable>
                <p:commandButton value="Asignar" process="tablaUsuarios" update=":formCasos:agregaSolicitante:datosUsuario" oncomplete="agregaUsuario.hide();"/>

            </p:dialog>



        </h:form>


    </ui:define>  

</ui:composition>


