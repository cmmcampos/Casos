<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../plantilla/plantilla4.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core">


    <ui:define name="content">

        <h:form id="formReasigna"  prependId="true" style="width: 100%" >
            <p:panelGrid style="width: 100%;">
                <f:facet name="header">
            <p:row>
                <p:column colspan="4"><h:outputLabel value=".: REQUERIMIENTO A REASIGNAR :."/></p:column>
            </p:row>
                </f:facet>
            </p:panelGrid>
                    
                    
            <p:panelGrid style="width: 100%;">
                <f:facet name="header">
                    <p:row>
                        <p:column colspan="4"><h:outputLabel value="1- Datos del Usuario Solicitante"/></p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column colspan="1"><h:outputLabel value="Nombre:   " style="font-weight: bold"/></p:column>
                    <p:column colspan="3"><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.nombreUsuario}  #{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.apellidoUsuario}" /></p:column>                                   
                </p:row>                                
                <p:row>
                    <p:column><h:outputLabel value="Teléfono: " style="font-weight: bold"/></p:column> 
                    <p:column><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.telefonoUsuario}" /></p:column>
                    <p:column><h:outputLabel value="Correo Electrónico:" style="font-weight: bold"/></p:column> 
                    <p:column><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.correoUsuario}" /></p:column> 
                </p:row>

                <p:row>
                    <p:column colspan="1"><h:outputLabel value="Dependencia a la que pertenece:  " style="font-weight: bold"/> </p:column>
                    <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.idDependencia.nombreDependencia}"/> </p:column>
                    <p:column colspan="1"><h:outputLabel value="Jefe de la Dependencia:  " style="font-weight: bold"/> </p:column>
                    <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.idDependencia.jefeDependencia}"/> </p:column>                         
                </p:row>                                
                <p:row>
                    <p:column colspan="1"><h:outputLabel value="Dependencia / Unidad organizativa:  " style="font-weight: bold"/> </p:column>
                    <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.idDependencia.idDirecInter.nombreDirecInter}"/> </p:column>
                    <p:column colspan="1"><h:outputLabel value="Dirección Nacional:  " style="font-weight: bold"/> </p:column>
                    <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.usuarioUsuarioSolicitante.idDependencia.idDirecInter.idDirNacional.nombreDirNacional}"/> </p:column>                          
                </p:row>   
            </p:panelGrid>                        





            <p:panelGrid style="width: 100%;">
                <f:facet name="header">
                    <p:row>
                        <p:column colspan="6"><h:outputLabel value="2- Detalle del Requerimiento"/></p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column><h:outputLabel value="N° de Caso: " style="font-weight: bold"/></p:column>
                    <p:column colspan="1">
                        <h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.numCaso}"></h:outputText>
                    </p:column>
                    <p:column>
                        <h:outputText value="Estado: " style="font-weight: bold"></h:outputText>
                    </p:column>
                    <p:column>
                        <h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.idEstado.nombreEstado}"></h:outputText>
                    </p:column>
                    <p:column colspan="1"><h:outputLabel value="Fecha del Requerimiento: " style="font-weight: bold"/></p:column>
                    <p:column colspan="2"> <h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.fechaRequerimiento}">
                            <f:convertDateTime pattern="dd/MM/yyyy" locale="es">

                            </f:convertDateTime>
                        </h:outputText> </p:column>


                </p:row>
                <p:row>
                    <p:column><h:outputLabel value="Categoría del Servicio: " style="font-weight: bold"/></p:column>
                    <p:column colspan="3">
                        <h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.idCatServ.nombreCatServ}"></h:outputText>

                    </p:column>    
                    <p:column >
                        <h:outputText value="Via de solicitud:" style="font-weight: bold"></h:outputText>
                    </p:column>
                    <p:column >
                        <h:outputText value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.idViaSolicitud.nombreViaSolicitud}"/>
                    </p:column>  
                </p:row>
                <p:row>
                    <p:column colspan="4" style="text-align: center"><h:outputLabel value="Descripción de requerimiento" style="font-weight: bold"/></p:column>
                    <p:column colspan="2" style="text-align: center"><h:outputLabel value="Documentos Adjuntos" style="font-weight: bold"/></p:column>
                </p:row>
                <p:row>                                
                    <p:column colspan="4" style="text-align: center">
                        <p:inputTextarea value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.descripcionRequerimiento}" rows="5" style="width: 99%;"  autoResize="false"  disabled="true"/>
                    </p:column>
                    <c:if test="#{controladorAdicionCaso.requerimientoAsigSeleccionado.documentacionCompleta}">                                  

                        <p:column colspan="2">
                            <center><p:commandButton value="Ver Adjuntos" onstart="verDoc.show();"></p:commandButton></center>
                        </p:column>
                    </c:if>
                    <c:if test="#{!controladorAdicionCaso.requerimientoAsigSeleccionado.documentacionCompleta}" >
                        <p:column colspan="3"><center><h:outputLabel value="No requiere documentos"/></center></p:column>
                    </c:if>                                
                </p:row>                            
            </p:panelGrid>





            <p:panelGrid id="datosR" style="width: 100%;">
                <f:facet name="header">
                    <p:row>
                        <p:column colspan="8"><h:outputLabel value="3- Detalle de Asignación"/></p:column>
                    </p:row>
                </f:facet>
                <p:row>


                    <p:column colspan="1"><h:outputText value="Fecha de asignación:" style="font-weight: bold"/></p:column>
                    <p:column colspan="1"><h:outputText value="#{controladorAdicionCaso.detalleDeLaAsignacion.fechaAsigna}"  >
                            <f:convertDateTime pattern="dd/MM/yyyy" locale="es"></f:convertDateTime>
                        </h:outputText></p:column>
                    <p:column colspan="1"><h:outputText value="Tiempo de atención:" style="font-weight: bold"/></p:column>
                    <p:column colspan="1" >
                        <h:outputText value="#{controladorAdicionCaso.detalleDeLaAsignacion.tiempoAtencion}   #{controladorAdicionCaso.detalleDeLaAsignacion.tipoDeTiempo}"  >

                        </h:outputText>
                    </p:column>

                    <p:column colspan="1">


                        <h:outputText  style="font-weight: bold" value="Técnico: "></h:outputText>        

                    </p:column>
                    <p:column colspan="1">
                        <c:if test="#{appSession.usuario.idRol.nombreRol.equals('Super administrador') or appSession.usuario.idRol.nombreRol.equals('Coordinador')}">
                            <h:outputText   value="#{controladorAdicionCaso.tecnicoSeleccionadoPorSuperAdmin.usuarioUsuario.nombreUsuario}  #{controladorAdicionCaso.tecnicoSeleccionadoPorSuperAdmin.usuarioUsuario.apellidoUsuario}"></h:outputText>
                        </c:if>
                        <c:if test="#{appSession.usuario.idRol.nombreRol.equals('Tecnico')}">
                            <h:outputText   value="#{appSession.usuario.nombreUsuario}  #{appSession.usuario.apellidoUsuario}"></h:outputText>    
                        </c:if>

                    </p:column>  
                    <p:column>
                        <h:outputText style="font-weight: bold" value="Peso Asignado:"/>
                    </p:column>
                    <p:column>
                        <h:outputText value="#{controladorAdicionCaso.detalleDeLaAsignacion.peso}"/>
                    </p:column>


                </p:row>                                <p:row>
                    <p:column><h:outputText value="Diagnostico: " style="font-weight: bold"></h:outputText></p:column>
                    <p:column colspan="7">
                        <p:inputTextarea  disabled="true" style="width: 680px; height: 40px" autoResize="false"  value="#{controladorAdicionCaso.detalleDeLaAsignacion.descripcionAsigna}"></p:inputTextarea>
                    </p:column>
                </p:row>

            </p:panelGrid>





            <center> 
                <p:commandButton  icon="ui-icon-disk" value="Seleccione nuevo tecnico"  onclick="cambiaTecnico.show();"></p:commandButton>
                <p:commandButton  icon="ui-icon-disk" value="Guardar Reasignación"  action="#{controladorAdicionCaso.crearReasignacion()}" process="@this" oncomplete="redireccionar()"></p:commandButton>
                <p:growl id="msgf"/> 
            </center>
            <script language="javascript">
                function redireccionar() {
                    setTimeout("javascript:location.replace('cat_listaCasosReasignar.xhtml')", 900);}
            </script>
        </h:form>






        <h:form id="verdoc">
            <p:dialog id="ventanadoc" header="Documentos Adjuntos:" widgetVar="verDoc" modal="true" visible="false">

                <p:dataTable id="tablaDocAdjuntos" value="#{controladorAdicionCaso.requerimientoAsigSeleccionado.documentosList}" var="item12"  rows="3">                   

                    <p:column>       
                        <f:facet name="header">
                            <h:outputText value="Nombre del Documento"/>
                        </f:facet>
                        <h:outputText value="#{item12.nombreDocumento}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="Descargar"/>
                        </f:facet>
                        <p:commandButton value="Download" icon="ui-icon-arrowthick-1-s" ajax="false">  
                            <p:fileDownload value="#{controladorAdicionCaso.asigFile12(item12)}" />  
                        </p:commandButton> 
                    </p:column>  
                </p:dataTable>


            </p:dialog>
        </h:form>





        <h:form id="formularioModificarTec">
            <p:dialog id="kidge" header="Seleccione nuevo Tecnico:" widgetVar="cambiaTecnico" modal="true" visible="false">
                <p:outputPanel id="kkjkkgtr">

                    <p:dataTable id="tablaTecnicoPeso" var="item" value="#{controladorAdicionCaso.traeTecnicosConSuPeso1}" 
                                 rowKey="#{item.idTecnico}" paginator="true" rows="10"  selection="#{controladorAdicionCaso.tecnicoConUnPesoSeleccionado}" selectionMode="single"
                                 >
                        <p:column >

                            <f:facet name="header">
                                <h:outputText value="ID"/>
                            </f:facet>
                            <h:outputText value="#{item.idTecnico}"/>
                        </p:column>    
                        <p:column >

                            <f:facet name="header">
                                <h:outputText value="Nombre del Tecnico"/>
                            </f:facet>
                            <h:outputText value="#{item.nombre}"/>
                        </p:column>


                        <p:column >

                            <f:facet name="header">
                                <h:outputText value="Peso total Asignado"/>
                            </f:facet>
                            <h:outputText value="#{item.sumaPeso}"/>
                        </p:column>

                    </p:dataTable>
                    <p:commandButton id="xc" value="Seleccionar" action="#{controladorAdicionCaso.asignaIdNuevoTecnico()}" update="msg12 " oncomplete="cambiaTecnico.hide();"/>
                    <!--en el update estaba refernciando al tab  :formReasigna:detalles:datosR--> 
                    <p:growl id="msg12"/>  
                </p:outputPanel>
            </p:dialog>

        </h:form>



    </ui:define>

</ui:composition>

